# Customer Import System

é¡§å®¢ãƒ‡ãƒ¼ã‚¿CSVã®è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»é‡è¤‡æ¤œçŸ¥ãƒ»è§£æ±ºã‚·ã‚¹ãƒ†ãƒ 

## ğŸ“‹ æ¦‚è¦

CSV/Excelãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«ãŠã‘ã‚‹å®Ÿå‹™èª²é¡Œï¼ˆè¡¨è¨˜ã‚†ã‚Œã€é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã€å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’è§£æ±ºã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

## âœ¨ ä¸»è¦æ©Ÿèƒ½

### 1. S3ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- presigned URLã«ã‚ˆã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è² è·ã®å‰Šæ¸›ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ç¢ºä¿

### 2. è‡ªå‹•é‡è¤‡æ¤œçŸ¥
- **å®Œå…¨ä¸€è‡´**: email/phoneå®Œå…¨ä¸€è‡´ â†’ æ—¢å­˜é¡§å®¢ã‚’è‡ªå‹•æ›´æ–°
- **é¡ä¼¼åº¦æ¤œçŸ¥**: Levenshteinè·é›¢ã«ã‚ˆã‚‹åå‰ã®é¡ä¼¼åˆ¤å®š â†’ æ‰‹å‹•è§£æ±ºå€™è£œã¸

### 3. é‡è¤‡è§£æ±ºUI
- æ—¢å­˜é¡§å®¢ã¨æ–°è¦ãƒ‡ãƒ¼ã‚¿ã®æ¯”è¼ƒè¡¨ç¤º
- 3ã¤ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠ
  - **ãƒãƒ¼ã‚¸**: æ—¢å­˜é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’æ–°è¦ãƒ‡ãƒ¼ã‚¿ã§æ›´æ–°
  - **æ–°è¦ä½œæˆ**: åˆ¥é¡§å®¢ã¨ã—ã¦æ–°è¦ç™»éŒ²
  - **ç„¡è¦–**: ã‚¹ã‚­ãƒƒãƒ—

### 4. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
- FastAPI BackgroundTasksã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†
- å¤§é‡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œï¼ˆ20ä»¶/ç´„3ç§’ï¼‰

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### Frontend
- React 18 + TypeScript
- Vite (ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«)
- TailwindCSS

### Backend
- FastAPI (Python 3.11)
- SQLAlchemy (ORM)
- MySQL 8.0
- boto3 (AWS SDK)

### Infrastructure
- Docker + Docker Compose
- AWS (ECS Fargate, RDS, ALB, Secrets Manager, WAF)
- Terraform (Infrastructure as Code)
- GitHub Actions (CI/CD)

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- Levenshteinè·é›¢ï¼ˆæ–‡å­—åˆ—é¡ä¼¼åº¦è¨ˆç®—ï¼‰

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   presigned URL   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ React App   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  S3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚
       â”‚ ã‚¤ãƒ³ãƒãƒ¼ãƒˆæŒ‡ä»¤               â”‚ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
       â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  MySQL   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   CRUDæ“ä½œ      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ Infrastructure (AWS + Terraform)

æœ¬ç•ªç’°å¢ƒã‚’æƒ³å®šã—ãŸAWSã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã‚’Terraformã§å®Œå…¨è‡ªå‹•åŒ–ã€‚

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Internet  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ALB        â”‚ â† WAF (prod)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ECS Fargate    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚React â”‚â”‚Fastâ”‚â”‚
â”‚ â”‚      â”‚â”‚API â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RDS MySQL     â”‚
â”‚ (Secrets Mgr)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»è¦æ©Ÿèƒ½

- **ç’°å¢ƒåˆ†é›¢**: staging/productionç’°å¢ƒã‚’å®Œå…¨åˆ†é›¢
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–**: å†åˆ©ç”¨å¯èƒ½ãªTerraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆVPC, ECS, RDS, Secrets, WAFï¼‰
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: Secrets Managerã€WAFã€Private Subnet
- **CI/CD**: GitHub Actionsã§terraform planè‡ªå‹•å®Ÿè¡Œ
- **ã‚³ã‚¹ãƒˆæœ€é©åŒ–**: Apply/Destroyé‹ç”¨ã§æœˆé¡$2-3ã«æŠ‘åˆ¶

### ç’°å¢ƒå·®åˆ†

| é …ç›® | Staging | Production |
|------|---------|------------|
| RDS | Single-AZ | Multi-AZ + 7æ—¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| ECS | 256CPU/512MBÃ—1 | 512CPU/1024MBÃ—2 |
| WAF | ãªã— | âœ… æœ‰åŠ¹ |
| æœˆé¡ã‚³ã‚¹ãƒˆ | ~$40-50 (24/7) | ~$85-100 (24/7) |

### è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

å®Œå…¨ãªæ§‹ç¯‰æ‰‹é †ã€ã‚³ã‚¹ãƒˆè©¦ç®—ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ [infra/README.md](./infra/README.md) ã‚’å‚ç…§ã€‚

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Docker Desktop
- Node.js 20+
- AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆS3ãƒã‚±ãƒƒãƒˆä½œæˆæ¸ˆã¿ï¼‰

### 1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
```bash
git clone https://github.com/tk53582005/customer-import.git
cd customer-import
```

### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š
```bash
# backend/.env ã‚’ä½œæˆ
cat > backend/.env <<EOF
DATABASE_URL=mysql+pymysql://app:app_pass@mysql:3306/customer_import?charset=utf8mb4
CORS_ORIGINS=http://localhost:5173
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=ap-northeast-1
AWS_S3_BUCKET=your_bucket_name
EOF
```

### 3. èµ·å‹•
```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆDockerï¼‰
docker compose up -d

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
npm install
npm run dev
```

### 4. ã‚¢ã‚¯ã‚»ã‚¹
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: http://localhost:5173
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API: http://localhost:8000/docs

## ğŸ–¼ï¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

### S3ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
![S3 Upload](docs/screenshots/import.png)

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆå±¥æ­´
![Import History](docs/screenshots/history.png)

### é‡è¤‡è§£æ±ºUI
![Duplicate Resolution](docs/screenshots/duplicates.png)

## ğŸ¯ å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

- âœ… Phase 1-3: åŸºç¤æ©Ÿèƒ½ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- âœ… Phase 4: é‡è¤‡æ¤œçŸ¥ãƒ»è§£æ±ºUI
- âœ… Phase 5: S3ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ + ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨éš”é›¢ï¼ˆ.gitignore + .git/info/excludeï¼‰
- pre-pushãƒ•ãƒƒã‚¯ã«ã‚ˆã‚‹æ©Ÿå¯†æƒ…å ±æ¼æ´©é˜²æ­¢
- AWS presigned URLã«ã‚ˆã‚‹æ™‚é™å¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¨©é™

## ğŸ“ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿

CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹ï¼š
```csv
é¡§å®¢å,TEL,Mail
å±±ç”° å¤ªéƒ,090-1234-5678,taro.yamada@example.com
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
cd backend
python -m pytest tests/ -v

# Dockerç’°å¢ƒï¼ˆæ¨å¥¨ï¼‰
docker compose exec backend pytest tests/ -v
```

**æ³¨æ„**: DBæ¥ç¶šãŒå¿…è¦ãªãƒ†ã‚¹ãƒˆã¯Dockerç’°å¢ƒã§ã®å®Ÿè¡Œã‚’æ¨å¥¨

## ğŸ¤ é–‹ç™ºè€…

[@tk53582005](https://github.com/tk53582005)

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
